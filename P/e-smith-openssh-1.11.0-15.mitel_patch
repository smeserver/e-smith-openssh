Index: e-smith-openssh/e-smith-openssh.spec
diff -u /dev/null e-smith-openssh/root/etc/e-smith/db/configuration/defaults/sshd/Protocol:1.1
--- /dev/null	Tue May 17 16:59:16 2005
+++ e-smith-openssh/root/etc/e-smith/db/configuration/defaults/sshd/Protocol	Tue May 17 16:58:47 2005
@@ -0,0 +1 @@
+2
Index: e-smith-openssh/root/etc/e-smith/db/configuration/migrate/sshd.protocol
diff -u /dev/null e-smith-openssh/root/etc/e-smith/db/configuration/migrate/sshd.protocol:1.1
--- /dev/null	Tue May 17 16:59:16 2005
+++ e-smith-openssh/root/etc/e-smith/db/configuration/migrate/sshd.protocol	Tue May 17 16:58:47 2005
@@ -0,0 +1,9 @@
+{
+    my $sshd = $DB->get('sshd');
+    return '' unless $sshd;
+    my $protocol = $sshd->prop('Protocol');
+    return '' if $protocol;
+
+    # Add backwards compatible mode for upgrades
+    $sshd->merge_props( Protocol => '2,1' );
+}
Index: e-smith-openssh/root/etc/e-smith/templates/etc/ssh/sshd_config/20Protocol
diff -u e-smith-openssh/root/etc/e-smith/templates/etc/ssh/sshd_config/20Protocol:1.1.1.1 e-smith-openssh/root/etc/e-smith/templates/etc/ssh/sshd_config/20Protocol:1.2
--- e-smith-openssh/root/etc/e-smith/templates/etc/ssh/sshd_config/20Protocol:1.1.1.1	Thu Feb 14 15:51:15 2002
+++ e-smith-openssh/root/etc/e-smith/templates/etc/ssh/sshd_config/20Protocol	Tue May 17 16:58:47 2005
@@ -1 +1,4 @@
-{ #Protocol 2,1 }
+{
+    my $protocol = $sshd{Protocol} || "2";
+    "Protocol $protocol";
+}
